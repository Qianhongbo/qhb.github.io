---
title: 内存对齐
date: 2022-11-20 13:16:35
categories: 
- c++
tags: 
- c++
---

## 内存对齐的目的

主要是由于 CPU 的访问内存的特性决定，CPU 访问内存时并不是以字节为单位来读取内存，而是**以机器字长为单位**，实际机器字长**由 CPU 数据总线宽度决定**的。实际 CPU 运行时，每一次控制内存读写信号发生时，CPU 可以从内存中读取数据总线宽度的数据，并将其写入到 CPU 的通用寄存器中。比如 32 位 CPU，机器字长为 **4 字节**，数据总线宽度为 32 位，如果该 CPU 的地址总线宽度也是为 3232 位，则其可以访问的地址空间为[0,0xffffffff]。

内存对齐的主要目的是为了**减少 CPU 访问内存的次数**，**加大 CPU 访问内存的吞吐量**。假设读取 8 个字节的数据，按照每次读取 4 个字节的速度，则 8 个字节需要 CPU 耗费 2 次读取操作。CPU 始终以字长访问内存，如果不进行内存对齐，很可能增加 CPU 访问内存的次数。

![](https://pic.leetcode-cn.com/1661173255-dXASLi-1_5_1.png)

比如以上在读取变量 `b` 时，如果不进行内存对齐的话，会导致 `CPU` 读取次数为 `2`，在内存对齐的情况下，只需读取一次即可。
